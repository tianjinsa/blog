<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Tianjinsaçš„åšå®¢å½’æ¡£ - æŒ‰æ—¶é—´æµè§ˆæ‰€æœ‰æ–‡ç« ">
    <meta name="keywords" content="Tianjinsa, åšå®¢, æŠ€æœ¯åˆ†äº«, å¼€å‘ç¬”è®°, å½’æ¡£">
    <meta name="author" content="Tianjinsa">
    <!-- ç½‘ç«™å›¾æ ‡ -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ“</text></svg>">
    <!-- ç¤¾äº¤åª’ä½“é¢„è§ˆ -->
    <meta property="og:title" content="åšå®¢å½’æ¡£ - Tianjinsa">
    <meta property="og:description" content="æŒ‰æ—¶é—´æµè§ˆæ‰€æœ‰æ–‡ç« ">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tianjinsa.github.io/blog/archives.html">
    <title>åšå®¢å½’æ¡£ - Tianjinsa</title>
    <!-- å¼•å…¥æ ·å¼æ–‡ä»¶ -->
    <link rel="stylesheet" href="styles.css">
    <!-- æ·»åŠ å›¾æ ‡åº“ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <style>
        .archives-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .year-section {
            margin-bottom: 40px;
        }
        
        .year-heading {
            font-size: 1.8em;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
            margin-bottom: 20px;
            color: white;
        }
        
        .month-section {
            margin-bottom: 30px;
        }
        
        .month-heading {
            font-size: 1.4em;
            margin-bottom: 15px;
            color: var(--accent-color);
        }
        
        .archive-list {
            list-style: none;
            padding: 0;
        }
        
        .archive-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .archive-item:last-child {
            border-bottom: none;
        }
        
        .archive-date {
            color: var(--text-muted);
            font-size: 0.9em;
            min-width: 100px;
        }
        
        .archive-title {
            flex-grow: 1;
            padding: 0 15px;
        }
        
        .archive-title a {
            color: var(--text-color);
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .archive-title a:hover {
            color: var(--accent-color);
        }
        
        .archive-tag {
            font-size: 0.8em;
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <a href="index.html" class="navbar-brand">Tianjinsa</a>
        <ul class="navbar-links">
            <li><a href="index.html"><i class="bi bi-house"></i> é¦–é¡µ</a></li>
            <li><a href="archives.html" class="active"><i class="bi bi-archive"></i> å½’æ¡£</a></li>
            <li><a href="tags.html"><i class="bi bi-tags"></i> æ ‡ç­¾</a></li>
            <li><a href="about.html"><i class="bi bi-person"></i> å…³äº</a></li>
        </ul>
        <div class="navbar-toggle" id="navbar-toggle">
            <i class="bi bi-list"></i>
        </div>
    </nav>

    <div class="container">
        <div class="content-wrapper">
            <div class="page-header">
                <h1>åšå®¢å½’æ¡£</h1>
                <p>æŒ‰æ—¶é—´æµè§ˆæ‰€æœ‰æ–‡ç« </p>
            </div>
            
            <div id="archives-content" class="archives-container">
                <div class="loading-indicator">
                    <p>æ­£åœ¨åŠ è½½å½’æ¡£å†…å®¹...</p>
                </div>
            </div>
        </div>

        <!-- é¡µè„š -->
        <footer class="footer">
            <p>&copy; <span id="current-year">2025</span> Tianjinsa. ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚</p>
            <p>ä½¿ç”¨ <a href="https://pages.github.com/" target="_blank">GitHub Pages</a> æ„å»º</p>
        </footer>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const archivesContentEl = document.getElementById('archives-content');
            const navbarToggleEl = document.getElementById('navbar-toggle');
            const navbarLinksEl = document.querySelector('.navbar-links');
            
            // è®¾ç½®å½“å‰å¹´ä»½
            document.getElementById('current-year').textContent = new Date().getFullYear();
            
            // ç§»åŠ¨ç«¯å¯¼èˆªèœå•åˆ‡æ¢
            if (navbarToggleEl && navbarLinksEl) {
                navbarToggleEl.addEventListener('click', function() {
                    navbarLinksEl.classList.toggle('active');
                });
            }
            
            const repoOwner = 'tianjinsa';
            const repoName = 'blog';
            const blogPath = '_posts';
            
            // ä»GitHubè·å–åšå®¢æ–‡ä»¶åˆ—è¡¨
            fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/${blogPath}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('è·å–åšå®¢åˆ—è¡¨å¤±è´¥');
                    }
                    return response.json();
                })
                .then(files => {
                    // è¿‡æ»¤å‡º.mdæ–‡ä»¶å¹¶æŒ‰æ—¥æœŸæ’åº
                    const blogFiles = files
                        .filter(file => file.name.endsWith('.md'))                        .sort((a, b) => {
                            // å‡è®¾æ–‡ä»¶åæ ¼å¼ä¸º: YYYY-MM-DD-hh-mm-ss-title.md
                            const dateA = a.name.substring(0, 19);
                            const dateB = b.name.substring(0, 19);
                            return dateB.localeCompare(dateA); // é™åºæ’åˆ—
                        });
                    
                    if (blogFiles.length === 0) {
                        archivesContentEl.innerHTML = `
                            <div class="no-blogs">
                                <p>æš‚æ— åšå®¢æ–‡ç« </p>
                            </div>
                        `;
                        return;
                    }
                    
                    // æŒ‰å¹´ä»½å’Œæœˆä»½ç»„ç»‡åšå®¢æ–‡ç« 
                    const blogsByYearMonth = {};
                    
                    // å¤„ç†æ¯ä¸ªåšå®¢æ–‡ä»¶
                    const fetchPromises = blogFiles.map(file => {
                        return fetch(file.download_url)
                            .then(response => response.text())
                            .then(content => {
                                // è§£æfrontmatterå’Œå†…å®¹
                                const frontmatterMatch = content.match(/^---\n([\s\S]*?)\n---\n/);                                let title = file.name.replace(/^\d{4}-\d{2}-\d{2}-\d{2}-\d{2}-\d{2}-/, '').replace('.md', '');
                                const dateStr = file.name.substring(0, 19);
                                let tags = [];
                                
                                if (frontmatterMatch) {
                                    const frontmatter = frontmatterMatch[1];
                                    const titleMatch = frontmatter.match(/title:\s*"(.+?)"/);
                                    const tagsMatch = frontmatter.match(/tags:\s*\[(.*?)\]/);
                                    
                                    if (titleMatch) title = titleMatch[1];
                                    
                                    // è§£ææ ‡ç­¾
                                    if (tagsMatch) {
                                        tags = tagsMatch[1].split(',')
                                            .map(tag => tag.trim().replace(/["']/g, ''))
                                            .filter(tag => tag);
                                    }
                                }
                                
                                // åˆ›å»ºåšå®¢é“¾æ¥é¡µé¢åœ°å€ï¼Œä½¿ç”¨æ–‡ä»¶åä½œä¸ºé“¾æ¥
                                const blogUrl = `./posts/${file.name.replace('.md', '.html')}`;
                                
                                // è§£ææ—¥æœŸ
                                const year = dateStr.substring(0, 4);
                                const month = dateStr.substring(5, 7);
                                
                                // ç»„ç»‡æ•°æ®ç»“æ„
                                if (!blogsByYearMonth[year]) {
                                    blogsByYearMonth[year] = {};
                                }
                                
                                if (!blogsByYearMonth[year][month]) {
                                    blogsByYearMonth[year][month] = [];
                                }
                                
                                blogsByYearMonth[year][month].push({
                                    title,
                                    date: dateStr,
                                    url: blogUrl,
                                    tags
                                });
                            })
                            .catch(error => {
                                console.error(`åŠ è½½åšå®¢ ${file.name} å¤±è´¥:`, error);
                            });
                    });
                    
                    // å¤„ç†æ‰€æœ‰åšå®¢å†…å®¹åŠ è½½å®Œæˆåçš„æ“ä½œ
                    Promise.all(fetchPromises)
                        .then(() => {
                            let archivesHTML = '';
                            
                            // è·å–æ’åºåçš„å¹´ä»½ï¼ˆé™åºï¼‰
                            const years = Object.keys(blogsByYearMonth).sort((a, b) => b - a);
                            
                            years.forEach(year => {
                                archivesHTML += `<div class="year-section">
                                    <h2 class="year-heading">${year}å¹´</h2>`;
                                
                                // è·å–æ’åºåçš„æœˆä»½ï¼ˆé™åºï¼‰
                                const months = Object.keys(blogsByYearMonth[year]).sort((a, b) => b - a);
                                
                                months.forEach(month => {
                                    const monthNames = {
                                        '01': 'ä¸€æœˆ', '02': 'äºŒæœˆ', '03': 'ä¸‰æœˆ', '04': 'å››æœˆ',
                                        '05': 'äº”æœˆ', '06': 'å…­æœˆ', '07': 'ä¸ƒæœˆ', '08': 'å…«æœˆ',
                                        '09': 'ä¹æœˆ', '10': 'åæœˆ', '11': 'åä¸€æœˆ', '12': 'åäºŒæœˆ'
                                    };
                                    
                                    archivesHTML += `<div class="month-section">
                                        <h3 class="month-heading">${monthNames[month]}</h3>
                                        <ul class="archive-list">`;
                                    
                                    blogsByYearMonth[year][month].forEach(post => {
                                        const day = post.date.substring(8, 10);
                                        const displayDate = `${month}-${day}`;
                                        
                                        // ç”Ÿæˆæ ‡ç­¾HTML
                                        let tagsHTML = '';
                                        if (post.tags && post.tags.length > 0) {
                                            tagsHTML = post.tags.map(tag => 
                                                `<span class="tag archive-tag">${tag}</span>`
                                            ).join('');
                                        }
                                        
                                        archivesHTML += `<li class="archive-item">
                                            <span class="archive-date">${displayDate}</span>
                                            <span class="archive-title"><a href="${post.url}">${post.title}</a></span>
                                            <span class="archive-tags">${tagsHTML}</span>
                                        </li>`;
                                    });
                                    
                                    archivesHTML += `</ul></div>`;
                                });
                                
                                archivesHTML += `</div>`;
                            });
                            
                            archivesContentEl.innerHTML = archivesHTML;
                        })
                        .catch(error => {
                            console.error('åŠ è½½å½’æ¡£å†…å®¹å¤±è´¥:', error);
                            archivesContentEl.innerHTML = `
                                <div class="error-message">
                                    <p>åŠ è½½å½’æ¡£å†…å®¹å‡ºé”™</p>
                                </div>
                            `;
                        });
                })
                .catch(error => {
                    console.error('è·å–åšå®¢åˆ—è¡¨å¤±è´¥:', error);
                    archivesContentEl.innerHTML = `
                        <div class="error-message">
                            <p>è·å–åšå®¢åˆ—è¡¨å¤±è´¥: ${error.message}</p>
                        </div>
                    `;
                });
        });
    </script>
</body>
</html>