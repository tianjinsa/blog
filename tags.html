<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Tianjinsaåšå®¢çš„æ ‡ç­¾é¡µ - é€šè¿‡æ ‡ç­¾æµè§ˆæ–‡ç« ">
    <meta name="keywords" content="Tianjinsa, åšå®¢, æ ‡ç­¾, æŠ€æœ¯åˆ†äº«">
    <meta name="author" content="Tianjinsa">
    <!-- ç½‘ç«™å›¾æ ‡ -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ“</text></svg>">
    <!-- ç¤¾äº¤åª’ä½“é¢„è§ˆ -->
    <meta property="og:title" content="æ ‡ç­¾ - Tianjinsaçš„åšå®¢">
    <meta property="og:description" content="é€šè¿‡æ ‡ç­¾æµè§ˆæ–‡ç« ">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tianjinsa.github.io/blog/tags.html">
    <title>æ ‡ç­¾ - Tianjinsaçš„åšå®¢</title>
    <!-- å¼•å…¥æ ·å¼æ–‡ä»¶ -->
    <link rel="stylesheet" href="styles.css">
    <!-- æ·»åŠ å›¾æ ‡åº“ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <style>
        .tags-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .tags-cloud {
            margin-bottom: 40px;
            text-align: center;
        }
        
        .tag-cloud-item {
            display: inline-block;
            margin: 8px 5px;
        }
        
        .tag-size-1 { font-size: 0.9em; }
        .tag-size-2 { font-size: 1.1em; }
        .tag-size-3 { font-size: 1.3em; }
        .tag-size-4 { font-size: 1.5em; }
        .tag-size-5 { font-size: 1.7em; }
        
        .tag-section {
            margin-bottom: 40px;
        }
        
        .tag-heading {
            font-size: 1.8em;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
            margin-bottom: 20px;
            color: var(--accent-color);
        }
        
        .tag-list {
            list-style: none;
            padding: 0;
        }
        
        .tag-item {
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.1);
        }
        
        .tag-item:last-child {
            border-bottom: none;
        }
        
        .tag-item-title {
            font-size: 1.1em;
        }
        
        .tag-item-title a {
            color: var(--text-color);
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .tag-item-title a:hover {
            color: var(--accent-color);
        }
        
        .tag-item-meta {
            font-size: 0.85em;
            color: var(--text-muted);
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <a href="index.html" class="navbar-brand">Tianjinsa</a>
        <ul class="navbar-links">
            <li><a href="index.html"><i class="bi bi-house"></i> é¦–é¡µ</a></li>
            <li><a href="archives.html"><i class="bi bi-archive"></i> å½’æ¡£</a></li>
            <li><a href="tags.html" class="active"><i class="bi bi-tags"></i> æ ‡ç­¾</a></li>
            <li><a href="about.html"><i class="bi bi-person"></i> å…³äº</a></li>
        </ul>
        <div class="navbar-toggle" id="navbar-toggle">
            <i class="bi bi-list"></i>
        </div>
    </nav>

    <div class="container">
        <div class="content-wrapper">
            <div class="page-header">
                <h1>æ–‡ç« æ ‡ç­¾</h1>
                <p>é€šè¿‡æ ‡ç­¾æµè§ˆæ–‡ç« </p>
            </div>
            
            <div class="tags-container">
                <div id="tags-cloud" class="tags-cloud">
                    <!-- æ ‡ç­¾äº‘å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                    <p>æ­£åœ¨åŠ è½½æ ‡ç­¾äº‘...</p>
                </div>
                
                <div id="tags-content">
                    <!-- æ ‡ç­¾å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                    <div class="loading-indicator">
                        <p>æ­£åœ¨åŠ è½½æ ‡ç­¾å†…å®¹...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- é¡µè„š -->
        <footer class="footer">
            <p>&copy; <span id="current-year">2025</span> Tianjinsa. ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚</p>
            <p>ä½¿ç”¨ <a href="https://pages.github.com/" target="_blank">GitHub Pages</a> æ„å»º</p>
        </footer>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const tagsCloudEl = document.getElementById('tags-cloud');
            const tagsContentEl = document.getElementById('tags-content');
            const navbarToggleEl = document.getElementById('navbar-toggle');
            const navbarLinksEl = document.querySelector('.navbar-links');
            
            // è®¾ç½®å½“å‰å¹´ä»½
            document.getElementById('current-year').textContent = new Date().getFullYear();
            
            // ç§»åŠ¨ç«¯å¯¼èˆªèœå•åˆ‡æ¢
            if (navbarToggleEl && navbarLinksEl) {
                navbarToggleEl.addEventListener('click', function() {
                    navbarLinksEl.classList.toggle('active');
                });
            }
              const repoOwner = 'tianjinsa';
            const repoName = 'tianjinsa.github.io';
            const blogPath = '_posts';
            
            // å­˜å‚¨æ ‡ç­¾æ•°æ®
            const tagData = {};
            
            // ä»GitHubè·å–åšå®¢æ–‡ä»¶åˆ—è¡¨
            fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/${blogPath}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('è·å–åšå®¢åˆ—è¡¨å¤±è´¥');
                    }
                    return response.json();
                })
                .then(files => {
                    // è¿‡æ»¤å‡º.mdæ–‡ä»¶
                    const blogFiles = files.filter(file => file.name.endsWith('.md'));
                    
                    if (blogFiles.length === 0) {
                        tagsCloudEl.innerHTML = `<p>æš‚æ— æ ‡ç­¾</p>`;
                        tagsContentEl.innerHTML = `<p>æš‚æ— åšå®¢æ–‡ç« </p>`;
                        return;
                    }
                    
                    // å¤„ç†æ¯ä¸ªåšå®¢æ–‡ä»¶
                    const fetchPromises = blogFiles.map(file => {
                        return fetch(file.download_url)
                            .then(response => response.text())
                            .then(content => {
                                // è§£æfrontmatterå’Œå†…å®¹
                                const frontmatterMatch = content.match(/^---\n([\s\S]*?)\n---\n/);
                                let title = file.name.replace(/^\d{4}-\d{2}-\d{2}-/, '').replace('.md', '');
                                let date = file.name.substring(0, 10);
                                let tags = [];
                                
                                if (frontmatterMatch) {
                                    const frontmatter = frontmatterMatch[1];
                                    const titleMatch = frontmatter.match(/title:\s*"(.+?)"/);
                                    const dateMatch = frontmatter.match(/date:\s*"(.+?)"/);
                                    const tagsMatch = frontmatter.match(/tags:\s*\[(.*?)\]/);
                                    
                                    if (titleMatch) title = titleMatch[1];
                                    if (dateMatch) {
                                        const dateObj = new Date(dateMatch[1]);
                                        date = dateObj.toLocaleDateString('zh-CN', {
                                            year: 'numeric',
                                            month: 'long',
                                            day: 'numeric'
                                        });
                                    }
                                    
                                    // è§£ææ ‡ç­¾
                                    if (tagsMatch) {
                                        tags = tagsMatch[1].split(',')
                                            .map(tag => tag.trim().replace(/["']/g, ''))
                                            .filter(tag => tag);
                                    }
                                }
                                
                                // åˆ›å»ºåšå®¢é“¾æ¥é¡µé¢åœ°å€
                                const blogUrl = `./posts/${file.name.replace('.md', '.html')}`;
                                
                                // ç»„ç»‡æ ‡ç­¾æ•°æ®
                                tags.forEach(tag => {
                                    if (!tagData[tag]) {
                                        tagData[tag] = [];
                                    }
                                    
                                    tagData[tag].push({
                                        title,
                                        date,
                                        url: blogUrl
                                    });
                                });
                            })
                            .catch(error => {
                                console.error(`åŠ è½½åšå®¢ ${file.name} å¤±è´¥:`, error);
                            });
                    });
                    
                    // å¤„ç†æ‰€æœ‰åšå®¢å†…å®¹åŠ è½½å®Œæˆåçš„æ“ä½œ
                    Promise.all(fetchPromises)
                        .then(() => {
                            // ç”Ÿæˆæ ‡ç­¾äº‘
                            generateTagsCloud();
                            
                            // ç”Ÿæˆæ ‡ç­¾å†…å®¹
                            generateTagsContent();
                        })
                        .catch(error => {
                            console.error('åŠ è½½æ ‡ç­¾å†…å®¹å¤±è´¥:', error);
                            tagsContentEl.innerHTML = `
                                <div class="error-message">
                                    <p>åŠ è½½æ ‡ç­¾å†…å®¹å‡ºé”™</p>
                                </div>
                            `;
                        });
                })
                .catch(error => {
                    console.error('è·å–åšå®¢åˆ—è¡¨å¤±è´¥:', error);
                    tagsCloudEl.innerHTML = `
                        <div class="error-message">
                            <p>è·å–æ ‡ç­¾åˆ—è¡¨å¤±è´¥: ${error.message}</p>
                        </div>
                    `;
                });
            
            // ç”Ÿæˆæ ‡ç­¾äº‘
            function generateTagsCloud() {
                const tags = Object.keys(tagData);
                
                if (tags.length === 0) {
                    tagsCloudEl.innerHTML = `<p>æš‚æ— æ ‡ç­¾</p>`;
                    return;
                }
                
                // è®¡ç®—æ¯ä¸ªæ ‡ç­¾çš„æ–‡ç« æ•°
                const tagCounts = {};
                tags.forEach(tag => {
                    tagCounts[tag] = tagData[tag].length;
                });
                
                // æ‰¾å‡ºæœ€å°å’Œæœ€å¤§æ–‡ç« æ•°
                const counts = Object.values(tagCounts);
                const minCount = Math.min(...counts);
                const maxCount = Math.max(...counts);
                
                // è®¡ç®—æ ‡ç­¾å¤§å°ï¼ˆ1-5ï¼‰
                const getTagSize = (count) => {
                    if (maxCount === minCount) return 3;
                    const size = Math.ceil(((count - minCount) / (maxCount - minCount)) * 4) + 1;
                    return Math.min(Math.max(size, 1), 5);
                };
                
                // ç”ŸæˆHTML
                let cloudHTML = '';
                tags.sort().forEach(tag => {
                    const count = tagCounts[tag];
                    const size = getTagSize(count);
                    cloudHTML += `
                        <div class="tag-cloud-item">
                            <a href="#${tag}" class="tag tag-size-${size}">${tag} (${count})</a>
                        </div>
                    `;
                });
                
                tagsCloudEl.innerHTML = cloudHTML;
            }
            
            // ç”Ÿæˆæ ‡ç­¾å†…å®¹
            function generateTagsContent() {
                const tags = Object.keys(tagData);
                
                if (tags.length === 0) {
                    tagsContentEl.innerHTML = `<p>æš‚æ— æ ‡ç­¾å†…å®¹</p>`;
                    return;
                }
                
                let contentHTML = '';
                
                tags.sort().forEach(tag => {
                    const posts = tagData[tag];
                    
                    contentHTML += `
                        <div id="${tag}" class="tag-section">
                            <h2 class="tag-heading">${tag}</h2>
                            <ul class="tag-list">
                    `;
                    
                    posts.forEach(post => {
                        contentHTML += `
                            <li class="tag-item">
                                <div class="tag-item-title">
                                    <a href="${post.url}">${post.title}</a>
                                </div>
                                <div class="tag-item-meta">
                                    <span><i class="bi bi-calendar"></i> ${post.date}</span>
                                </div>
                            </li>
                        `;
                    });
                    
                    contentHTML += `
                            </ul>
                        </div>
                    `;
                });
                
                tagsContentEl.innerHTML = contentHTML;
            }
        });
    </script>
</body>
</html>
